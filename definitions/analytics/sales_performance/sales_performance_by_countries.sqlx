config {
    type: "view",
    schema: "analytics", 
    tags: ["analytics", "sales_performance"]
}

select 
    date_trunc(sales_date, month) as calend_month
    , region_name
    , country_name
    , is_key_country
    , sum(regular_price_usd) as regular_price_usd
    , sum(discounted_price_usd) as discounted_price_usd
from ${ref("sales_enriched")}
group by all 